@rem
@rem $Id$
@rem

@echo off

rem ---------------------------------------------------------------
rem Copyright 2009 Viktor Szakats (harbour.01 syenar.hu)
rem Copyright 2003 Przemyslaw Czerpak (druzus / at / priv.onet.pl)
rem simple script run after Harbour make install to finish install
rem process
rem
rem See COPYING for licensing terms.
rem ---------------------------------------------------------------

set _HBMK_CFG=%HB_BIN_INSTALL%\hbmk.cfg
echo Generating %_HBMK_CFG%...
echo # Harbour Make configuration> %_HBMK_CFG%
echo # Generated by Harbour build process>> %_HBMK_CFG%
echo arch=%HB_ARCHITECTURE%>> %_HBMK_CFG%
echo comp=%HB_COMPILER%>> %_HBMK_CFG%
set _HBMK_CFG=

goto inst_%HB_ARCHITECTURE%

:inst_win
:inst_wce
rem Windows post install part
if not "%OS%" == "Windows_NT" goto end

if "%HB_COMPILER%" == "mingw"    set HB_DYNLIB=yes
if "%HB_COMPILER%" == "mingw64"  set HB_DYNLIB=yes
if "%HB_COMPILER%" == "mingwarm" set HB_DYNLIB=yes
if "%HB_COMPILER%" == "cygwin"   set HB_DYNLIB=yes

if not "%HB_DYNLIB%" == "yes" goto _SKIP_DLL_BIN

   call %~dp0hb-mkdyn.bat

   setlocal
   if "%HB_BIN_COMPILE%" == "" set HB_BIN_COMPILE=%HB_BIN_INSTALL%
   if exist "%HB_BIN_INSTALL%\*.dll" (
      %HB_BIN_COMPILE%\hbmk2 -q0 -shared -o%HB_BIN_INSTALL%\hbrun-dll    %~dp0..\utils\hbrun\hbrun.hbp
      %HB_BIN_COMPILE%\hbmk2 -q0 -shared -o%HB_BIN_INSTALL%\hbmk2-dll    %~dp0..\utils\hbmk2\hbmk2.hbp
      %HB_BIN_COMPILE%\hbmk2 -q0 -shared -o%HB_BIN_INSTALL%\hbtest-dll   %~dp0..\utils\hbtest\hbtest.hbp
      %HB_BIN_COMPILE%\hbmk2 -q0 -shared -o%HB_BIN_INSTALL%\hbi18n-dll   %~dp0..\utils\hbi18n\hbi18n.hbp
      %HB_BIN_COMPILE%\hbmk2 -q0 -shared -o%HB_BIN_INSTALL%\hbformat-dll %~dp0..\utils\hbformat\hbformat.hbp
   )
   endlocal

:_SKIP_DLL_BIN

if "%HB_BUILD_IMPLIB%" == "yes" call %~dp0hb-mkimp.bat

goto end


:inst_dos
rem DOS post install part
goto end


:inst_
:end
